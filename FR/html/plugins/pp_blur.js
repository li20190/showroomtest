function A(a,e,b){return"precision highp float;uniform sampler2D sm;uniform vec2 sz,dr;uniform float seed,fbs;varying vec2 tx;const float PHI=1.61803398874989484820459*00000.1;const float PI=3.14159265358979323846264*00000.1;const float SQ2=1.41421356237309504880169*10000.0;float ns(in vec2 p,in float s){return fract(cos(distance(p*(s+PHI),vec2(PHI,PI)))*SQ2);}const float Q="+(a|0)+".0;void main(){float t=0.0,o=ns(tx,seed);vec2 d=fbs*dr/sz;vec3 c=vec3(0.0);for(float i=-Q;i<=Q;i++){float p=(i+o-0.5)/Q,w=1.0-abs(p);"+
(e?(b?"vec2 tp=tx+p*d;if(tp.x > 1.0) tp.x = 2.0 - tp.x;if(tp.y > 1.0) tp.y = 2.0 - tp.y;tp.x = abs(tp.x);tp.y = abs(tp.y);vec3 l=texture2D(sm,tp).rgb;":"vec3 l=texture2D(sm,tx+p*d).rgb;")+"c+=w*l*(l*(l*0.305306011+0.682171111)+0.012522878);":b?"vec2 tp=tx+p*d;if(tp.x > 1.0) tp.x = 2.0 - tp.x;if(tp.y > 1.0) tp.y = 2.0 - tp.y;tp.x = abs(tp.x);tp.y = abs(tp.y);c+=w*texture2D(sm,tp).rgb;":"c+=w*texture2D(sm,tx+p*d).rgb;")+"t+=w;}c/=t;"+(e?"vec3 c1=sqrt(c);vec3 c2=sqrt(c1);c=0.662002687*c1+0.684122060*c2-0.323583601*sqrt(c2)-0.0225411470*c;":
"")+"gl_FragColor=vec4(c,1.0);}"}function B(){var a=p|0;a!=w&&(w=a,C(),d=b.webGL.createPostProcessingShader(A(a,q,r),"dr,sz,seed,fbs","ppblur_pass1"),f=b.webGL.createPostProcessingShader(A(a,q,r),"dr,sz,seed,fbs","ppblur_pass2"))}function k(a,e,b,c){if("bool"==e)a="boolean"===typeof a?a:0<="yesontrue1".indexOf(String(a).toLowerCase());else if("number"==e){if(a=Number(a),isNaN(a))return}else"int"==e?a|=0:"lowstr"==e&&(a=(""+a).toLowerCase());a!=b&&c(a)}function E(a){k(a,"bool",t,function(a){t=a;g=
!0;h()})}function F(a){k(a,"number",l,function(a){l=0>a?0:1E3<a?1E3:a;h()})}function G(a){k(a,"number",p,function(a){p=1>a?1:50<a?50:a;g=!0;h()})}function H(a){k(a,"bool",q,function(a){q=a;g=!0;w=-1;h()})}function I(a){k(a,"bool",r,function(a){r=a;g=!0;w=-1;h()})}function J(a){k(a,"lowstr",m,function(a){m=a;g=!0;h()})}function K(a){k(a,"int",u,function(a){u=a;g=!0;h()})}function h(){0==y&&(y=!0,b.view.haschanged=!0,b.actions.nexttick(L))}function L(){var a=t;.01>=l&&(a=!1);if(a){if(g||0==v){z();B();
if(0==v){v=!0;var a=1==u?b.webGL.ppShaderArray2:b.webGL.ppShaderArray,e=parseFloat(m),e=isNaN(e)?m=1+a.length:e|0,e=m=D(a,e);a.push(d);a.push(f);d._sortorder=e+.1;f._sortorder=e+.2;a.sort(M)}g=!1}b.webGL.useShader(d);b.webGL.context.uniform2f(d.dr,0,l);b.webGL.useShader(f);b.webGL.context.uniform2f(f.dr,l,0);b.webGL.useShader(null)}else z();y=!1}function D(a,b){for(var c=0,d=a.length;c<d;c++)if((a[c]._sortorder|0)==b)return D(a,b+1);return b}function M(a,b){var c=a._sortorder,d=b._sortorder;if(void 0!==
c&&void 0!==d){if(c<d)return-1;if(c>d)return 1}else{if(void 0===c)return 1;if(void 0===d)return-1}return 0}function x(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b){a.splice(c,1);break}}function z(){1==v&&(v=!1,x(b.webGL.ppShaderArray,d),x(b.webGL.ppShaderArray,f),x(b.webGL.ppShaderArray2,d),x(b.webGL.ppShaderArray2,f))}function C(){b&&b.webGL&&(f&&(b.webGL.deleteShader(f),f=null),d&&(b.webGL.deleteShader(d),d=null))}var n=this;n.name="Blur Postprocessing Plugin";n.version="1.20";var b=null,c=null,
t=!0,l=0,p=10,q=!1,r=!1,m="",u=2,y=!1,g=!1,v=!1,w=0,d=null,f=null;n.registerplugin=function(a,e,g){b=a;c=g;if("1.20">b.version||"2019-01-01">b.build)b.trace(3,n.name+" - too old krpano version (min. 1.20)");else if(b.webGL){b.call("neednewlicense('"+n.name+"')");a=b.device;if(!a.desktop||1.5<a.pixelratio)p=5;c.registerattribute("enabled",t,E,function(){return t});c.registerattribute("range",l,F,function(){return l});c.registerattribute("quality",p,G,function(){return p});c.registerattribute("linearrgb",
q,H,function(){return q});c.registerattribute("mirroredges",r,I,function(){return r});c.registerattribute("order",m,J,function(){return m});c.registerattribute("phase",u,K,function(){return u});B();d&&f?h():n.unloadplugin()}};n.unloadplugin=function(){b&&c&&(z(),C(),delete c.enabled,delete c.filterrange,delete c.quality,delete c.linearrgb,delete c.order,delete c.phase,c=b=null)}